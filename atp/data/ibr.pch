KARD  3  4  5  6  7  8  9  9 10 10 11 11 12 12 12 13 13 13 14 14 14 14 14 15 15
     15 15 15 16 16 16 16 16 17 17 17 17 17 18 18 18 18 18 19 19 19 19 19 20 20
     20 20 20 21 21 21 21 24 24 24 24 24 27 27 27 28 28 31 31 34 34 37 37 40 40
     40 41 42 42 45 45 45 45 45 46 46 46 46 47 47 47 47 47 48 48 48 48 49 49 49
     49 49 49 50 50 50 50 50 50 51 51 54 54 60 60 66 66 66 67 67 70 70 71 71 71
     71 71 71 72 72 72 82 82 88 88 94 94 97 97 98 98 99 99 99100100100100101101
    101101101102102102102102103103105105105106106109109109109109110110112112112
    112112112112113113113113113113113113114114114114114114114114115115115116116
    116117117118118118119119120120121121121122122122122122123123123123126126126
    127127127127127128128128128128129129129129129129130130130130130130130131131
    134134137137137137137137137138138144144144144145145147147150150153153153153
    154154160160160160160161161162162164164167167167168168168169169169170170171
    171171171171171172172173173174174175175176176177177178179180181181182182183
    183184185187187188188189189190191192194194195195196196198199200
KARG  1  1  1-78-79-80 -1 -3 -2 -3 -4-75 -4 -5-76 -4 -5-77 -1 -2 -6-86-87 -1 -2
     -7-86-87 -1 -2 -8-13-14 -1 -2 -9-13-14 -6 -7 -8 -9-10 -6 -7 -8 -9-11 -6 -6
     -7 -7-12-15-16-36-54 22 23-19-20-44-15-21-22-12-23-10-24-11-25 -7-26-17-26
    -27-17 -3-27  1  1  1  3-86  1  1  3-87  5-13-78-79-80  5-14-79-80  5 -1 -2
     -4-21-73  5 -1 -2 -5-21-73-18-23-18-35-22-23 17-35-36-23-28  8-29 24 25 26
    -23-23-30-28-29-31-28-32-28-33-24-34  7-82  7-83-37-82-83 13 18-34-38 35 36
    -38-39-68 32 33-25-39-40 37 38-28-39-41-41-42-28-43-48-50-74 39 40-20-44-48
    -50-51-69-70 12 34 34-16-16-46-54-54 12 34 34-20-20-44-44-47-32-46-48-33-47
    -49-48-50-30-31-51  6-84  6-85-81-84-85 19 19-27-45-81 20 21-45-52-28-52-53
     20-16-49-53-54 -8 -8 -9 -9-71 31-28-28-71-71-72 15 15 28-23-25-63-72-55-63
    -25-56 14 14-29-37-55-56-57-57-58 35 36-58-59 41 42-59-60-24-61-17-17-27-62
    -62-64 16-61-64-65-81-65-66 43 44-66-67 13-60-68 11-42-69 11-43-70-19-73 10
     10 13-40-68-74  2-27  2-10  2-11  8-23  8-28  8-55  2  2  2  7-59  7-60  9
     -3-27-26-75-78-76-79-77-80-78-79-80  1-78  1-79  1-80-75-76-77
KBEG  3  3  3  3  3  3  3 16  3 16 21  3 22 40  3 22 40  3 19 35  3 12 28 36 20
      3 13 29 19 35  3 12 28 36 20  3 13 29 12 26 19 33  3 26 12 19 33  3 17 24
     31 38  3  3 12 75 12 63 57  3 12 12 13  3 20 28  3 28  3 28  3 12  3 36 20
      3  3  3 12 24 31 38 46  3 22 29 37  3 46  3 24 31 38 37  3 22 29 44 20 36
      3 13 29 44 36 20  3 13 29  3 12 28  3  3 28 12 19  3 12  3 12  3 33 57 12
     23 47  3 20 36  3 28  3 28  3 12  3 11  3 11  3  3 12 19 31 22 12  3 57 63
     20  3 36 63 57 36 20  3 15  5 22 13  3 12  3 36  3 75 69 20 15  5  3  3 75
     69 20 12 44 33 17 24 40 47  3 40 47 36 17 24 44 51 44 51  3 20 36  3 20 36
      3 15  3 22 13  3 11  3 11  3  3 12 19 26 36 43  3 12 57 63 12  3 22 13  3
     57  3 75 28  3 17 24 31 38  3 32 17 24 39 46  3 38 48 13 27 20  3 55  3 12
     12  3 31 41 49 13 56 20  3 28  3 57 63 28  3 15  5 12  3 12  3 13 32 22  3
     28  3 41 22 31  3 13 28  3 15  5 12  3 28 12  3 28 12  3 21 12  3 22  3 21
     44 59 12 30  3  3 12  3 12  3 12 11  3 11  3 11  3  3  3  3 11  3 11  3 11
      3  3  3  3  9  3  9  3  9  3  3  3  9  3  9  3  9  3  3  3  3
KEND  7  7  7  8  8  8  8 21  8 21 26  8 27 45  8 27 45  8 24 40  8 17 33 41 25
      8 18 34 24 40  8 17 33 41 25  8 18 34 17 31 24 38  8 31 17 24 38  8 22 29
     36 43  8  8 17 80 17 68 62  8 17 17 18  8 25 33  8 33  8 33  8 17  8 41 25
      8  8  8 17 28 35 42 55  8 26 33 46  8 55  8 29 36 43 46  8 27 34 53 25 41
      8 18 34 53 41 25  8 18 34  8 17 33  8  8 33 17 24  8 17  8 21  8 38 62 17
     28 52  8 25 41  8 33  8 33  8 17  8 20  8 20  8  8 17 24 36 27 17  8 62 68
     25  8 41 68 62 41 25  8 20 10 27 18  8 17  8 41  8 80 74 25 20 10  8  8 80
     74 25 17 49 38 22 29 45 52  8 45 52 41 22 29 49 56 49 56  8 25 41  8 25 41
      8 20  8 27 18  8 20  8 20  8  8 17 24 31 41 48  8 17 62 68 17  8 27 18  8
     62  8 80 33  8 22 29 36 43  8 37 22 29 44 51  8 43 53 18 32 25  8 60  8 17
     17  8 36 46 54 18 61 25  8 33  8 62 68 33  8 20 10 17  8 17  8 18 37 27  8
     33  8 46 27 36  8 18 33  8 20 10 17  8 33 17  8 33 17  8 26 17  8 27  8 26
     49 64 17 35  8  7 17  7 17  7 17 20  8 20  8 20  8  7  7  7 20  8 20  8 20
      8  8  8  8 14  8 14  8 14  8  8  8 13  8 13  8 13  8  8  8  8
KTEX  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  1  0  0  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  1  0  1  1  1  0  1  0  1  1  1  1  0  1  1  1  0  1  1
      1  1  1  0  1  1  1  1  1  1  1  1  1  1  1  0  1  1  1  1  0  1  0  0  0
      1  1  1  1  1  1  1  1  1  1  1  1  0  1  0  1  1  1  1  0  0  1  1  0  0
      1  1  1  0  0  1  1  1  0  0  1  1  1  1  1  1  1  1  1  1  0  0  1  1  1
      1  1  1  1  0  0  0  1  1  1  1  1  0  0  0  1  1  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  0  1  0  1  1  1  1  0  0  1  1  1  0  0  1  1  1  1  1
      0  1  1  1  1  1  1  1  1  1  0  1  1  1  1  1  0  0  0  1  1  1  1  1  1
      1  1  0  0  1  1  1  1  1  1  1  0  0  1  1  0  0  1  1  1  1  1  1  1  1
      1  1  0  1  1  1  1  1  1  0  0  1  1  0  1  1  0  1  1  0  1  1  1  1  0
      0  0  1  1  1  1  1  1  1  1  1  0  1  0  1  0  1  1  1  1  0  1  0  1  0
      1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
$ERASE
/TACS
90__PCCA                                                           -1.      1.E3
90__PCCB                                                           -1.      1.E3
90__PCCC                                                           -1.      1.E3
91___IGA                                                                    1.E3
91___IGB                                                                    1.E3
91___IGC                                                                    1.E3
99_COSTH  =COS(_THETA)
99_SINTH  =SIN(_THETA)
98____IA  =0.816497*_ALPHA
98____IB  =-0.408248*_ALPHA + 0.707107*__BETA
98____IC  =-0.408248*_ALPHA - 0.707107*__BETA
99___VGD  =_VALPH*_COSTH + _VBETA*_SINTH
99___VGQ  =-_VALPH*_SINTH + _VBETA*_COSTH
99___IGD  =_IALPH*_COSTH + _IBETA*_SINTH
99___IGQ  =-_IALPH*_SINTH + _IBETA*_COSTH
99__PDQ0  =___VGD*___IGD+___VGQ*___IGQ
99__QDQ0  =___VGQ*___IGD-___VGD*___IGQ
99___VGR  =SQRT(___VGD*___VGD+___VGQ*___VGQ)
 1_IPREF  +_IPCMD                                     1.                  _LVPRR
        1.
        1.       .02
 1_IQREF  +_IQCMD                                     1._IQRMN_IQRMX
        1.
        1.       .02
99____ID  =-_IPREF*_LVACM
 2__VGPU                  +___VGR                     1.
        1.
        1.    .01667  6.944E-5
 2____PG                  +__PDQ0                     1.
        1.
        1.    .01667  6.944E-5
 2____QG                  +__QDQ0                     1.
        1.
        1.    .01667  6.944E-5
 1____DW  +___VGQ                                     1.
    1.34E5     188.5
                  1.
 0____WE          -____DW         +____WC             1.
98____WC  = 376.9911
 1_THETA  +____WE                                     1.
        1.
                  1.
99_VALPH  =0.408248*(2*__PCCA-__PCCB-__PCCC)/__VOLTBASE
99_VBETA  =0.707107*(__PCCB-__PCCC)/__VOLTBASE
99_IALPH  =0.408248*(2*___IGA-___IGB-___IGC)/__CURRBASE
99_IBETA  =0.707107*(___IGB-___IGC)/__CURRBASE
99_ALPHA  =(____ID*_COSTH - ____IQ*_SINTH)*__CURRBASE
99__BETA  =(____ID*_SINTH + ____IQ*_COSTH)*__CURRBASE
 1_VLVPL  +__VGPU                                     1.
        1.
        1.      .015
98__LVPL56                +_VLVPL                     1.
              -1               0
             0.4               0
             0.9             1.2
              10             1.2
           9999.
98_LVACM56                +__VGPU                     1.
              -1               0
             0.4               0
             0.8               1
              10               1
           9999.
99_LVPRR  =_LVPSW*__LVPL
 1_VFILT  +__VGPU                                     1.
        1.
        1.       .03
98_VREF0  =____VREFPU
98__VSUP  =___KQV * ((__VGPU.LT.__VDIP) .OR. (__VGPU.GT.___VUP))
98_IQVRF56        -_VFILT         +_VREF0             1.
      -100000000           -1.05
           -1.05           -1.05
           -0.05           -0.05
         -0.0499               0
          0.0499               0
            0.05            0.05
            1.05            1.05
       100000000            1.05
           9999.
98__VDL156                +_VFILT                     1.
              -1               1
               2               1
               3               1
               4               1
           9999.
98__VDL256                +_VFILT                     1.
              -1               1
               2               1
               3               1
               4               1
           9999.
 1_PELEC  +____PG                                     1.
        1.
        1.       .05
24__IX16  _______QPU       .01                                     .01       .02
11__IX17  _______QPU                                               .02      1.E3
98__QREF  =__IX16+__IX17
99___QPF  =_PELEC * (_TANPF * _PFFLG)
 0_QCTRL          +___QPF         +__QEXT             1.__QMIN__QMAX
 1__QREG          +_QCTRL         -____QG             1._VQMIN_VQMAX
    ___KQI    ___KQP
                  1.
98____ND  = _QCTRL / _VFILT
 1_NDFLT  +____ND                                     1.
        1.
        1.      .015
 1_IQRAW          +_VFGIN         -_VFILT             1.            _IQMIN_IQMAX
    ___KVI    ___KVP
                  1.
 0_IQCMD  +_NDFLG +_IQINJ                 +_IQFLG     1.            _IQMIN_IQMAX
98_IQLIM  =SQRT(__IMAX*__IMAX - _PQFLG*_IPCMD*_IPCMD)*(TIMEX.GT.0.25)
98_IPLIM  =SQRT(__IMAX*__IMAX - (1-_PQFLG)*_IQCMD*_IQCMD)
98_IQMAX63        +__VDL1         +_IQLIM                  -1.
98_IPMAX63        +__VDL2         +_IPLIM                  -1.
98_IQMIN  = - _IQMAX
98_IQINJ  = _IQVRF * __VSUP
24__IX18  _______PPU       .01                                     .01       .02
11__IX19  _______PPU                                               .02      1.E3
98__PREF  =__IX18+__IX19
99_PREFW  =__PREF * (NOT(_PFLAG) + _PFLAG*____WE)
 1__PORD  +_PREFW                                     1.__PMIN__PMAX
        1.
        1.       .03
98_IPRAW  = __PORD / _VFILT
 0_IPCMD                  +_IPRAW                     1.__PMIN            _IPMAX
99___IGR  =SQRT(___IGD*___IGD+___IGQ*___IGQ)
99__VLDC  =SQRT(_VFILT*_VFILT-(___ZC2*___IGR*___IGR))
99_VCTRL  =(____KC*____QG+__VGPU)*(1-_LDCFG) + _LDCFG*__VLDC
 1_VCLAG  +_VCTRL                                     1.
        1.
        1.       .02
 1_QGLAG  +____QG                                     1.
        1.
        1.       .02
99__QEX1  =(__QREF-_QGLAG)*(1-_REFFG) + _REFFG*(_VREF0-_VCLAG)
98__QEX256                +__QEX1                     1.
           -2000            -999
            -999            -999
             999             999
            2000             999
           9999.
 1__QEX3                  +__QEX2                     1.__QMIN__QMAX
    ____KI    ____KP
                  1.
 1__QEX4  +__QEX3                                     1.
        1.
        1.       .08
 1_PGLAG  +____PG                                     1.
        1.
        1.       .03
99___DWP  =(____WC - ____WE) / ____WC
98__DWDB56                +___DWP                    20.
           -9999              -1
           -0.06              -1
           -0.01               0
            1000               0
           9999.
99__PEX1  =(__PREF - _PGLAG + __DWDB) * _FRQFG
 1__PEX2                  +__PEX1                     1.          1.
    ___KIG    ___KPG
                  1.
 1__PEX3  +__PEX2                                     1.
        1.
        1.       .08
99__QEXT  =__QEX4 * (1.0 - _PFFLG)
99_NDFLG  =_NDFLT * (1.0 - _QFLAG)
99_IQFLG  =_IQRAW * _QFLAG
98____IQ  =     1. * _IQREF
99_VFGIN  =__QREG * _VFLAG + __QEXT * (1.0-_VFLAG) * (1.0-_PFFLG)
98__OUTF  =____WE
98__OUTP  =__PDQ0
98__OUTQ  =__QDQ0
77__VGPU  ____VREFPU
77_VFILT  ____VREFPU
77_VCLAG  ____VREFPU
77__OUTF    376.9911
77__OUTP          0.
77__OUTQ          0.
77__QEX3  _______QPU
77__QEX4  _______QPU
77_THETA  ___ICTHETA
77____WE    376.9911
77____DW          0.
/BRANCH
  ____IA___IGA             0.001
  ____IB___IGB             0.001
  ____IC___IGC             0.001
  ___IGA                    1.E3        .001                                   0
  ___IGB                    1.E3        .001                                   0
  ___IGC                    1.E3        .001                                   0
/SWITCH
  ___IGA__PCCA                                        MEASURING                0
  ___IGB__PCCB                                        MEASURING                0
  ___IGC__PCCC                                        MEASURING                0
/SOURCE
60____IA-1                                                         -1.      1.E3
60____IB-1                                                         -1.      1.E3
60____IC-1                                                         -1.      1.E3
$EOF   User-supplied header cards follow.         25-Feb-26  13:31:34
ARG __PCC, __OUT
ARG __VOLTBASE, _POWERBASE, __CURRBASE, _______PPU, _______QPU, ____VREFPU
ARG ___ICTHETA, _VFLAG, _QFLAG, _PQFLG, _PFFLG, _REFFG, _LDCFG, _FRQFG
ARG _LVPSW, _TANPF, _PFLAG, __PMIN, __PMAX, _IQRMX, _IQRMN, __VDIP, ___VUP
ARG ___KQV, _IOLIM, ____KC, ____RC, ____XC, ___ZC2, _VQMAX, _VQMIN, __IMAX
ARG __QMIN, __QMAX, ___KQP, ___KQI, ___KVP, ___KVI, ____KP, ____KI, ___KPG
ARG ___KIG
NUM __VOLTBASE, _POWERBASE, __CURRBASE, _______PPU, _______QPU, ____VREFPU
NUM ___ICTHETA, _VFLAG, _QFLAG, _PQFLG, _PFFLG, _REFFG, _LDCFG, _FRQFG
NUM _LVPSW, _TANPF, _PFLAG, __PMIN, __PMAX, _IQRMX, _IQRMN, __VDIP, ___VUP
NUM ___KQV, _IOLIM, ____KC, ____RC, ____XC, ___ZC2, _VQMAX, _VQMIN, __IMAX
NUM __QMIN, __QMAX, ___KQP, ___KQI, ___KVP, ___KVI, ____KP, ____KI, ___KPG
NUM ___KIG
DUM _COSTH, _SINTH, _THETA, _ALPHA, __BETA, ___VGD, ___VGQ, ___IGD, ___IGQ
DUM __PDQ0, __QDQ0, ___VGR, _IALPH, _IBETA, _IPREF, _IPCMD, ____WC, _VLVPL
DUM _IQREF, _IQCMD, ____ID, _LVACM, __VGPU, ____PG, ____QG, ____DW, ____WE
DUM _VFILT, _VREF0, __VSUP, _IQVRF, __VDL1, __VDL2, _PELEC, __LVPL, _LVPRR
DUM __QREF, ___QPF, _QCTRL, __QREG, ____ND, _NDFLT, _IQRAW, _IQCMD, _PREFW
DUM _IQLIM, _IPLIM, _IQMAX, _IPMAX, _IQMIN, _IQINJ, __PORD, _IPRAW, _IPCMD
DUM _VCLAG, _QGLAG, __QEX1, __QEX2, __QEX3, __QEX4, _PGLAG, ___DWP, _VCTRL
DUM __DWDB, __PEX1, __PEX2, __PEX3, __QEXT, _NDFLG, _IQFLG, ___IGR, __VLDC
DUM ____IQ, _VFGIN, ____IA, ____IB, ____IC, ___IGA, ___IGB, ___IGC, __PREF
DUM __IX16, __IX17, __IX18, __IX19, _VALPH, _VBETA
