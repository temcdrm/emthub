KARD  3  4  5  6  7  8  9  9 10 10 11 11 12 12 12 13 13 13 14 14 14 14 14 15 15
     15 15 15 16 16 16 16 16 17 17 17 17 17 18 18 18 18 18 19 19 19 19 19 20 20
     20 20 20 21 22 23 23 23 23 26 26 26 26 26 29 29 29 30 30 33 33 36 36 39 39
     42 42 42 43 44 44 47 47 47 47 47 48 48 48 48 49 49 49 49 49 50 50 50 50 51
     51 51 51 51 51 52 52 52 52 52 52 53 53 56 56 62 62 68 68 68 69 70 71 72 73
     74 74 77 77 78 78 78 78 78 78 79 79 79 89 89 95 95101101104105105106106107
    107107108108108108109109109110110110110110113113113114114117117117117117120
    121121121121121121121122123124124124124124124124124125125125125125125125125
    126126126127127127128128129129129130131132132133133134134134135135135135135
    136137137137137140141142142142143143143143143144145146146146146146147148149
    150150150150150150151152152152152152152152153154155155158158161161161161161
    161161162162168168171171174174177177177177178178184184184184184185186186189
    189192193193193194194194195195195196196197198198198198198198199199200200201
    201202202203203204204205206207208208209209210210211212214214215215216216217
    218219221221222222223223225226227
KARG  1  1  1114115116 -1 -3 -2 -3 -4111 -4 -5112 -4 -5113 -1 -2 -6121122 -1 -2
     -7121122 -1 -2 -8-15-16 -1 -2 -9-15-16 -6 -7 -8 -9-10 -6 -7 -8 -9-11 -6 -6
     -7 -7-12-13-14-17-18-31-70-13-14-19-20-53-17-21-22-12-23-10-24-11-25 -7-26
    -26-27-28-28 -3-27  1  1  1  3121  1  1  3122  5-15114115116  5-16115116  5
     -1 -2 -4-21-99  5 -1 -2 -5-21-99-23-29-29-30-22-23-30-31-32-32-33-34-35-36
    -23-37  8-38-23-23-34-35-36-39-37-38-40-37-41-37-42-24-43-44  7117  7118-45
    117118-43-44-46-95-46-47-96-25-47-48-71-72-37-47-49-49-50-37-51-58-60110-52
    -20-53-58-60-61-97-98-54-55-18-18-54-54-55-56-70-70-20-20-53-53-54-54-55-57
    -41-56-58-42-57-59-58-60-39-40-61-62-63  6119  6120119120123-27-64-65-65123
    -65-64-66-67-68-67-68-37-66-69-18-59-67-69-70-71-72 -8 -8 -9 -9-73-74-75-76
    -37-37-73-73-77-78-78-23-25-74-77-79-80-80-80-81-79-82-25-83-38-45-81-81-82
    -83-84-84-85-85-86-86-87-24-88-27-28-28-89-89-90-88-90-91-92123-92-91-93-93
    -94-95-87-95-96-50-63-97-51-63-98-19-99109-48-95-96109109110  2-27  2-10  2
    -11  8-23  8-37  8-82  2  2  2  7-86  7-87  9 -3-27-26111114112115113116114
    115116  1114  1115  1116111112113
KBEG  3  3  3  3  3  3  3 16  3 16 21  3 22 40  3 22 40  3 19 35  3 12 28 36 20
      3 13 29 19 35  3 12 28 36 20  3 13 29 12 26 19 33  3 26 12 19 33  3 17 24
     31 38  3  3  3  3 12 75 12 75 69  3 12 12 13  3 20 28  3 28  3 28  3 12  3
     20  3 36  3  3 12 24 31 38 46  3 22 29 37  3 46  3 24 31 38 37  3 22 29 44
     20 36  3 13 29 44 36 20  3 13 29 12  3 28  3  3 28 19  3 12  3  3  3  3  3
     12  3 12  3 23 47 12 57 33  3 20 36  3 28  3 28  3 12  3  3 11  3 11  3  3
     12 19 12 21  3 30 20  3 36 36 20  3 75 69 22 13  3 12  3 36  3 75 69 20  3
      3  3 75 69 20 12 44  3  3 40 47 17 24 33  3 40 47 44 51 44 51 17 24 36  3
     20 36  3 20 36  3 15  3 22 13  3  3  3 11  3 11  3 12 19  3 43  3 26 36 12
      3 12  3 69 75  3  3 22 13  3  3 75 69 28  3  3  3 17 24 31 38  3  3  3  3
     17 24 39 46  3 32  3 27 20 13 55  3 38 48  3  3 12  3 12  3 49 13 31 41 56
     20  3 28  3 28  3 12  3 12  3 22 13 32  3 28  3 22 31  3 41 13  3 28  3 12
      3  3 12 28  3 12 28  3 12 21  3 22  3  3 12 59 30 21 44  3  3 12  3 12  3
     12 11  3 11  3 11  3  3  3  3 11  3 11  3 11  3  3  3  3  9  3  9  3  9  3
      3  3  9  3  9  3  9  3  3  3  3
KEND  7  7  7  8  8  8  8 21  8 21 26  8 27 45  8 27 45  8 24 40  8 17 33 41 25
      8 18 34 24 40  8 17 33 41 25  8 18 34 17 31 24 38  8 31 17 24 38  8 22 29
     36 43  8  8  8  8 17 80 17 80 74  8 17 17 18  8 25 33  8 33  8 33  8 17  8
     25  8 41  8  8 17 28 35 42 55  8 26 33 46  8 55  8 29 36 43 46  8 27 34 53
     25 41  8 18 34 53 41 25  8 18 34 17  8 33  8  8 33 24  8 17  8  8  8  8  8
     17  8 21  8 28 52 17 62 38  8 25 41  8 33  8 33  8 17  8  8 20  8 20  8  8
     17 24 17 26  8 35 25  8 41 41 25  8 80 74 27 18  8 17  8 41  8 80 74 25  8
      8  8 80 74 25 17 49  8  8 45 52 22 29 38  8 45 52 49 56 49 56 22 29 41  8
     25 41  8 25 41  8 20  8 27 18  8  8  8 20  8 20  8 17 24  8 48  8 31 41 17
      8 17  8 74 80  8  8 27 18  8  8 80 74 33  8  8  8 22 29 36 43  8  8  8  8
     22 29 44 51  8 37  8 32 25 18 60  8 43 53  8  8 17  8 17  8 54 18 36 46 61
     25  8 33  8 33  8 17  8 17  8 27 18 37  8 33  8 27 36  8 46 18  8 33  8 17
      8  8 17 33  8 17 33  8 17 26  8 27  8  8 17 64 35 26 49  8  7 17  7 17  7
     17 20  8 20  8 20  8  7  7  7 20  8 20  8 20  8  8  8  8 14  8 14  8 14  8
      8  8 13  8 13  8 13  8  8  8  8
KTEX  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  1  1  1  0  1  1  1  0  1  0  1  1  1  1  0  1  1  1  0
      1  1  1  1  1  0  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      1  1  0  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  1  0  1  1
      1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  1  1  1  1  1  1  1  0  1  0  1  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      1  0  1  0  1  0  1  1  1  1  0  1  0  1  0  1  1  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  1  1  1  1  1
NONDUM =  9
$ERASE
/TACS
90__PCCA                                                           -1.      1.E3
90__PCCB                                                           -1.      1.E3
90__PCCC                                                           -1.      1.E3
91___IGA                                                                    1.E3
91___IGB                                                                    1.E3
91___IGC                                                                    1.E3
99_COSTH  =COS(_THETA)
99_SINTH  =SIN(_THETA)
98____IA  =0.816497*_ALPHA
98____IB  =-0.408248*_ALPHA + 0.707107*__BETA
98____IC  =-0.408248*_ALPHA - 0.707107*__BETA
99___VGD  =_VALPH*_COSTH + _VBETA*_SINTH
99___VGQ  =-_VALPH*_SINTH + _VBETA*_COSTH
99___IGD  =_IALPH*_COSTH + _IBETA*_SINTH
99___IGQ  =-_IALPH*_SINTH + _IBETA*_COSTH
99__PDQ0  =___VGD*___IGD+___VGQ*___IGQ
99__QDQ0  =___VGQ*___IGD-___VGD*___IGQ
99___VGR  =SQRT(___VGD*___VGD+___VGQ*___VGQ)
98_IQRMX  =    999.9
98_IQRMN  =   -999.9
 1_IPREF  +_IPCMD                                     1.                  _LVPRR
        1.
        1.       .02
 1_IQREF  +_IQCMD                                     1.            _IQRMN_IQRMX
        1.
        1.       .02
99____ID  =-_IPREF*_LVACM
 2__VGPU                  +___VGR                     1.
        1.
        1.    .01667  6.944E-5
 2____PG                  +__PDQ0                     1.
        1.
        1.    .01667  6.944E-5
 2____QG                  +__QDQ0                     1.
        1.
        1.    .01667  6.944E-5
 1____DW  +___VGQ                                     1.
    1.34E5     188.5
                  1.
 0____WE          -____DW         +____WC             1.
98____WC  = 376.9911
 1_THETA  +____WE                                     1.
        1.
                  1.
99_VALPH  =0.408248*(2*__PCCA-__PCCB-__PCCC)/__VOLTBASE
99_VBETA  =0.707107*(__PCCB-__PCCC)/__VOLTBASE
99_IALPH  =0.408248*(2*___IGA-___IGB-___IGC)/__CURRBASE
99_IBETA  =0.707107*(___IGB-___IGC)/__CURRBASE
99_ALPHA  =(____ID*_COSTH - ____IQ*_SINTH)*__CURRBASE
99__BETA  =(____ID*_SINTH + ____IQ*_COSTH)*__CURRBASE
 1_VLVPL  +__VGPU                                     1.
        1.
        1.      .015
98__LVPL56                +_VLVPL                     1.
              -1               0
             0.4               0
             0.9             1.2
              10             1.2
           9999.
98_LVACM56                +__VGPU                     1.
              -1               0
             0.4               0
             0.8               1
              10               1
           9999.
99_LVPRR  =_LVPSW*__LVPL
98_LVPSW  =       1.
98_IOLIM  =     -1.2
98___KCV  =      0.0
98_VSWEL  =     1.15
98__VSAG  =     0.87
 1_VFILT  +__VGPU                                     1.
        1.
        1.       .03
98_VREF0  =____VREFPU
98__VDIP  =___KCV * ((__VGPU.LT.__VSAG) .OR. (__VGPU.GT._VSWEL))
98_IQVRF56        -_VFILT         +_VREF0             1.
      -100000000           -1.05
           -1.05           -1.05
           -0.05           -0.05
         -0.0499               0
          0.0499               0
            0.05            0.05
            1.05            1.05
       100000000            1.05
           9999.
98__VDL156                +_VFILT                     1.
              -1               1
               2               1
               3               1
               4               1
           9999.
98__VDL256                +_VFILT                     1.
              -1               1
               2               1
               3               1
               4               1
           9999.
 1_PELEC  +____PG                                     1.
        1.
        1.       .05
98_TANPF  = -0.20306
24__IX16  _______QPU       .01                                     .01       .02
11__IX17  _______QPU                                               .02      1.E3
98__QREF  =__IX16+__IX17
99___QPF  =_PELEC * _TANPF * _PFFLG
 0_QCTRL          +___QPF         +__QEXT             1.   -.7    .7
 1__QREG          +_QCTRL         -____QG             1.            _VQMIN_VQMAX
        .1        .1
                  1.
98____ND  = _QCTRL / _VFILT
 1_NDFLT  +____ND                                     1.
        1.
        1.      .015
 1_IQRAW          +_VFGIN         -_VFILT             1.            _IQMIN_IQMAX
        1.        5.
                  1.
98_IQFRZ  =      0.0
 0_IQCMD  +_NDFLG +_IQINJ                 +_IQFLG     1.            _IQMIN_IQMAX
98__IMAX  =      1.2
98_PQFLG  =      0.0
98_IQLIM  =SQRT(__IMAX*__IMAX - _PQFLG*_IPCMD*_IPCMD)*(TIMEX.GT.0.25)
98_IPLIM  =SQRT(__IMAX*__IMAX - (1-_PQFLG)*_IQCMD*_IQCMD)
98_IQMAX63        +__VDL1         +_IQLIM                  -1.
98_IPMAX63        +__VDL2         +_IPLIM                  -1.
98_IQMIN  = - _IQMAX
98_IQINJ  = _IQVRF * __VDIP
98_VREF1  =      0.0
98_QFLAG  =       0.
24__IX18  _______PPU       .01                                     .01       .02
11__IX19  _______PPU                                               .02      1.E3
98__PREF  =__IX18+__IX19
99_PREFW  =__PREF * (NOT(_RFLAG) + _RFLAG*____WE)
98_RFLAG  =      0.0
 1__PORD  +_PREFW                                     1.            __PMIN__PMAX
        1.
        1.       .03
98__PMIN  =      0.0
98__PMAX  =       1.
98_IPRAW  = __PORD / _VFILT
 0_IPCMD                  +_IPRAW                     1.            __PMIN_IPMAX
98_VQMAX  =     1.07
98_VQMIN  =      0.9
99___IGR  =SQRT(___IGD*___IGD+___IGQ*___IGQ)
98____KC  =      0.0
98____RC  =    0.001
98____XC  =     0.01
99__VLDC  =SQRT(_VFILT*_VFILT-(___ZC2*___IGR*___IGR))
98___ZC2  =  1.01E-4
99_VCTRL  =(____KC*____QG+__VGPU)*(1-_LDCFG) + _LDCFG*__VLDC
98_LDCFG  =      0.0
98_REFFG  =       1.
 1_VCLAG  +_VCTRL                                     1.
        1.
        1.       .02
 1_QGLAG  +____QG                                     1.
        1.
        1.       .02
99__QEX1  =(__QREF-_QGLAG)*(1-_REFFG) + _REFFG*(_VREF0-_VCLAG)
98__QEX256                +__QEX1                     1.
           -2000            -999
            -999            -999
             999             999
            2000             999
           9999.
 1__QEX3                  +__QEX2                     1.   -.7    .7
        1.       10.
                  1.
 1__QEX4  +__QEX3                                     1.
        1.
        1.       .08
 1_PGLAG  +____PG                                     1.
        1.
        1.       .03
99___DWP  =(____WC - ____WE) / ____WC
98__DWDB56                +___DWP                    20.
           -9999              -1
           -0.06              -1
           -0.01               0
            1000               0
           9999.
99__PEX1  =(__PREF - _PGLAG + __DWDB) * _FRQFG
98_FRQFG  =       1.
 1__PEX2                  +__PEX1                     1.          1.
       .05        .1
                  1.
 1__PEX3  +__PEX2                                     1.
        1.
        1.       .08
98_PFFLG  =      0.0
99__QEXT  =__QEX4 * (1.0 - _PFFLG)
99_NDFLG  =_NDFLT * (1.0 - _QFLAG)
99_IQFLG  =_IQRAW * _QFLAG
98____IQ  =     1. * _IQREF
98_VFLAG  =       0.
99_VFGIN  =__QREG * _VFLAG + __QEXT * (1.0-_VFLAG) * (1.0-_PFFLG)
98__OUTF  =____WE
98__OUTP  =__PDQ0
98__OUTQ  =__QDQ0
77__VGPU  ____VREFPU
77_VFILT  ____VREFPU
77_VCLAG  ____VREFPU
77__OUTF    376.9911
77__OUTP          0.
77__OUTQ          0.
77__QEX3  _______QPU
77__QEX4  _______QPU
77_THETA  ___ICTHETA
77____WE    376.9911
77____DW          0.
/BRANCH
  ____IA___IGA             0.001
  ____IB___IGB             0.001
  ____IC___IGC             0.001
  ___IGA                    1.E3        .001                                   0
  ___IGB                    1.E3        .001                                   0
  ___IGC                    1.E3        .001                                   0
/SWITCH
  ___IGA__PCCA                                        MEASURING                0
  ___IGB__PCCB                                        MEASURING                0
  ___IGC__PCCC                                        MEASURING                0
/SOURCE
60____IA-1                                                         -1.      1.E3
60____IB-1                                                         -1.      1.E3
60____IC-1                                                         -1.      1.E3
$EOF   User-supplied header cards follow.         07-Jan-26  18:48:51
ARG __PCC, __OUT
ARG __VOLTBASE, _POWERBASE, __CURRBASE, _______PPU, _______QPU, ____VREFPU
ARG ___ICTHETA
NUM __VOLTBASE, _POWERBASE, __CURRBASE, _______PPU, _______QPU, ____VREFPU
NUM ___ICTHETA
DUM _COSTH, _SINTH, _THETA, _ALPHA, __BETA, ___VGD, ___VGQ, ___IGD, ___IGQ
DUM __PDQ0, __QDQ0, ___VGR, _IQRMX, _IQRMN, _IALPH, _IBETA, _IPREF, _IPCMD
DUM _IQREF, _IQCMD, ____ID, _LVACM, __VGPU, ____PG, ____QG, ____DW, ____WE
DUM ____WC, _VLVPL, __LVPL, _LVPRR, _LVPSW, _IOLIM, ___KCV, _VSWEL
DUM __VSAG, _VFILT, _VREF0, __VDIP, _IQVRF, __VDL1, __VDL2, _PELEC, _TANPF
DUM __QREF, ___QPF, _QCTRL, __QREG, ____ND, _NDFLT, _IQRAW, _IQFRZ, _IQCMD
DUM __IMAX, _PQFLG, _IQLIM, _IPLIM, _IQMAX, _IPMAX, _IQMIN, _IQINJ, _VREF1
DUM _QFLAG, _PREFW, _RFLAG, __PORD, __PMIN, __PMAX, _IPRAW, _IPCMD, _VQMAX
DUM _VQMIN, ___IGR, ____KC, ____RC, ____XC, __VLDC, ___ZC2, _VCTRL, _LDCFG
DUM _REFFG, _VCLAG, _QGLAG, __QEX1, __QEX2, __QEX3, __QEX4, _PGLAG, ___DWP
DUM __DWDB, __PEX1, _FRQFG, __PEX2, __PEX3, _PFFLG, __QEXT, _NDFLG, _IQFLG
DUM ____IQ, _VFLAG, _VFGIN, ____IA, ____IB, ____IC, ___IGA, ___IGB, ___IGC
DUM __IX16, __IX17, __IX18, __IX19, _VALPH, _VBETA, __PREF
