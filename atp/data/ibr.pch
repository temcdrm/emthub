KARD  3  4  5  6  7  8  9  9 10 10 11 11 12 12 12 13 13 13 14 14 14 14 14 15 15
     15 15 15 16 16 16 16 16 17 17 17 17 17 18 18 18 18 18 19 19 19 19 19 20 20
     20 20 20 21 22 23 23 23 23 26 26 26 26 26 29 29 29 30 30 33 33 36 36 39 39
     42 42 42 43 44 44 47 47 47 47 47 48 48 48 48 49 49 49 49 49 50 50 50 50 51
     51 51 51 51 51 52 52 52 52 52 52 53 53 53 53 53 53 53 54 54 57 57 63 63 69
     69 69 70 71 72 73 74 75 75 78 78 79 79 79 79 79 79 80 80 80 90 90 96 96102
    102105106106107107108108108109109109109110110110111111111111111114114114115
    115118118118118118121122122122122122122122123124125125125125125125125125126
    126126126126126126126127127127128128128129129130130130131132133133134134135
    135135136136136136136137138138138138141142143143143144144144144144145146147
    147147147147148149150151151151151151151152153153153153153153153154155156156
    159159162162162162162162162163163169169172172175175178178178178179179185185
    185185185186187187190190193194194194195195195196196196197197198199199199199
    199199200200201201202202203203204204205205206206207207208209210212212213213
    214214215216217219219220220221221223224225
KARG  1  1  1114115116 -1 -3 -2 -3 -4111 -4 -5112 -4 -5113 -1 -2 -6121122 -1 -2
     -7121122 -1 -2 -8-15-16 -1 -2 -9-15-16 -6 -7 -8 -9-10 -6 -7 -8 -9-11 -6 -6
     -7 -7-12-13-14-17-18-32-71-13-14-19-20-54-17-21-22-12-23-10-24-11-25 -7-26
    -26-27-28-28 -3-27  1  1  1  3121  1  1  3122  5-15114115116  5-16115116  5
     -1 -2 -4-21108  5 -1 -2 -5-21108  1  1  1-29114115116-23-30-30-31-22-23-31
    -32-33-33-34-35-36-37-23-38  8-39-23-23-35-36-37-40-38-39-41-38-42-38-43-24
    -44-45  7117  7118-46117118-44-45-47-96-47-48-97-25-48-49-72-73-38-48-50-50
    -51-38-52-59-61110-53-20-54-59-61-62-98-99-55-56-18-18-55-55-56-57-71-71-20
    -20-54-54-55-55-56-58-42-57-59-43-58-60-59-61-40-41-62-63-64  6119  6120119
    120123-27-65-66-66123-66-65-67-68-69-68-69-38-67-70-18-60-68-70-71-72-73 -8
     -8 -9 -9-74-75-76-77-38-38-74-74-78-79-79-23-25-75-78-80-81-81-81-82-80-83
    -25-84-39-46-82-82-83-84-85-85-86-86-87-87-88-24-89-27-28-28-90-90-91-89-91
    -92-93123-93-92-94-94-95-96-88-96-97-51-64-98-52-64-99-19108109-49-96-97109
    109110  2-27  2-10  2-11  8-23  8-38  8-83  8-87  8-88  2  2  2111114112115
    113116114115116  1114  1115  1116111112113
KBEG  3  3  3  3  3  3  3 16  3 16 21  3 22 40  3 22 40  3 19 35  3 12 28 36 20
      3 13 29 19 35  3 12 28 36 20  3 13 29 12 26 19 33  3 26 12 19 33  3 17 24
     31 38  3  3  3  3 12 75 12 75 69  3 12 12 13  3 20 28  3 28  3 28  3 12  3
     20  3 36  3  3 12 24 31 38 46  3 22 29 37  3 46  3 24 31 38 37  3 22 29 44
     20 36  3 13 29 44 36 20  3 13 29 12 28 44  3 19 35 51 12  3 28  3  3 28 19
      3 12  3  3  3  3  3 12  3 12  3 23 47 12 57 33  3 20 36  3 28  3 28  3 12
      3  3 11  3 11  3  3 12 19 12 21  3 30 20  3 36 36 20  3 75 69 22 13  3 12
      3 36  3 75 69 20  3  3  3 75 69 20 12 44  3  3 40 47 17 24 33  3 40 47 44
     51 44 51 17 24 36  3 20 36  3 20 36  3 15  3 22 13  3  3  3 11  3 11  3 12
     19  3 43  3 26 36 12  3 12  3 69 75  3  3 22 13  3  3 75 69 28  3  3  3 17
     24 31 38  3  3  3  3 17 24 39 46  3 32  3 27 20 13 55  3 38 48  3  3 12  3
     12  3 49 13 31 41 56 20  3 28  3 28  3 12  3 12  3 22 13 32  3 28  3 22 31
      3 41 13  3 28  3 12  3  3 12 28  3 12 28  3 12 21  3 22  3  3 12 59 30 21
     44  3  3 12  3 12  3 12 11  3 11  3 11  3 11  3 11  3  3  3  3  3  9  3  9
      3  9  3  3  3  9  3  9  3  9  3  3  3  3
KEND  7  7  7  8  8  8  8 21  8 21 26  8 27 45  8 27 45  8 24 40  8 17 33 41 25
      8 18 34 24 40  8 17 33 41 25  8 18 34 17 31 24 38  8 31 17 24 38  8 22 29
     36 43  8  8  8  8 17 80 17 80 74  8 17 17 18  8 25 33  8 33  8 33  8 17  8
     25  8 41  8  8 17 28 35 42 55  8 26 33 46  8 55  8 29 36 43 46  8 27 34 53
     25 41  8 18 34 53 41 25  8 18 34 16 32 48  8 24 40 56 17  8 33  8  8 33 24
      8 17  8  8  8  8  8 17  8 21  8 28 52 17 62 38  8 25 41  8 33  8 33  8 17
      8  8 20  8 20  8  8 17 24 17 26  8 35 25  8 41 41 25  8 80 74 27 18  8 17
      8 41  8 80 74 25  8  8  8 80 74 25 17 49  8  8 45 52 22 29 38  8 45 52 49
     56 49 56 22 29 41  8 25 41  8 25 41  8 20  8 27 18  8  8  8 20  8 20  8 17
     24  8 48  8 31 41 17  8 17  8 74 80  8  8 27 18  8  8 80 74 33  8  8  8 22
     29 36 43  8  8  8  8 22 29 44 51  8 37  8 32 25 18 60  8 43 53  8  8 17  8
     17  8 54 18 36 46 61 25  8 33  8 33  8 17  8 17  8 27 18 37  8 33  8 27 36
      8 46 18  8 33  8 17  8  8 17 33  8 17 33  8 17 26  8 27  8  8 17 64 35 26
     49  8  7 17  7 17  7 17 20  8 20  8 20  8 20  8 20  8  7  7  7  8 14  8 14
      8 14  8  8  8 13  8 13  8 13  8  8  8  8
KTEX  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  1  1  1  0  1  1  1  0  1  0  1  1  1  1  0  1  1  1  0
      1  1  1  1  1  0  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  1  1  1  0  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      1  1  0  1  0  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  1  0  1  1
      1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  1  1  0  1  0  1  0  1  0  1  0  1  1  1  1  1  1  1  1
      1  1  1  1  1  1  1  1  1  1  1  1  1  1
NONDUM =  8
$ERASE
/TACS
90__PCCA                                                           -1.      1.E3
90__PCCB                                                           -1.      1.E3
90__PCCC                                                           -1.      1.E3
91___IGA                                                                    1.E3
91___IGB                                                                    1.E3
91___IGC                                                                    1.E3
99_COSTH  =COS(_THETA)
99_SINTH  =SIN(_THETA)
98____IA  =0.816497*_ALPHA
98____IB  =-0.408248*_ALPHA + 0.707107*__BETA
98____IC  =-0.408248*_ALPHA - 0.707107*__BETA
99___VGD  =_VALPH*_COSTH + _VBETA*_SINTH
99___VGQ  =-_VALPH*_SINTH + _VBETA*_COSTH
99___IGD  =_IALPH*_COSTH + _IBETA*_SINTH
99___IGQ  =-_IALPH*_SINTH + _IBETA*_COSTH
99__PDQ0  =___VGD*___IGD+___VGQ*___IGQ
99__QDQ0  =___VGQ*___IGD-___VGD*___IGQ
99___VGR  =SQRT(___VGD*___VGD+___VGQ*___VGQ)
98_IQRMX  =    999.9
98_IQRMN  =   -999.9
 1_IPREF  +_IPCMD                                     1.                  _LVPRR
        1.
        1.       .02
 1_IQREF  +_IQCMD                                     1.            _IQRMN_IQRMX
        1.
        1.       .02
99____ID  =-_IPREF*_LVACM
 2__VGPU                  +___VGR                     1.
        1.
        1.    .01667  6.944E-5
 2____PG                  +__PDQ0                     1.
        1.
        1.    .01667  6.944E-5
 2____QG                  +__QDQ0                     1.
        1.
        1.    .01667  6.944E-5
 1____DW  +___VGQ                                     1.
    1.34E5     188.5
                  1.
 0____WE          -____DW         +____WC             1.
98____WC  = 376.9911
 1_THETA  +____WE                                     1.
        1.
                  1.
99_VALPH  =0.408248*(2*__PCCA-__PCCB-__PCCC)/__VOLTBASE
99_VBETA  =0.707107*(__PCCB-__PCCC)/__VOLTBASE
99_IALPH  =0.408248*(2*___IGA-___IGB-___IGC)/__CURRBASE
99_IBETA  =0.707107*(___IGB-___IGC)/__CURRBASE
99_ALPHA  =(____ID*_COSTH - ____IQ*_SINTH)*__CURRBASE
99__BETA  =(____ID*_SINTH + ____IQ*_COSTH)*__CURRBASE
99_POWER  =__PCCA*___IGA + __PCCB*___IGB + __PCCC*___IGC
 1_VLVPL  +__VGPU                                     1.
        1.
        1.      .015
98__LVPL56                +_VLVPL                     1.
              -1               0
             0.4               0
             0.9             1.2
              10             1.2
           9999.
98_LVACM56                +__VGPU                     1.
              -1               0
             0.4               0
             0.8               1
              10               1
           9999.
99_LVPRR  =_LVPSW*__LVPL
98_LVPSW  =       1.
98_IOLIM  =     -1.2
98___KCV  =      0.0
98_VSWEL  =     1.15
98__VSAG  =     0.87
 1_VFILT  +__VGPU                                     1.
        1.
        1.       .03
98_VREF0  =____VREFPU
98__VDIP  =___KCV * ((__VGPU.LT.__VSAG) .OR. (__VGPU.GT._VSWEL))
98_IQVRF56        -_VFILT         +_VREF0             1.
      -100000000           -1.05
           -1.05           -1.05
           -0.05           -0.05
         -0.0499               0
          0.0499               0
            0.05            0.05
            1.05            1.05
       100000000            1.05
           9999.
98__VDL156                +_VFILT                     1.
              -1               1
               2               1
               3               1
               4               1
           9999.
98__VDL256                +_VFILT                     1.
              -1               1
               2               1
               3               1
               4               1
           9999.
 1_PELEC  +____PG                                     1.
        1.
        1.       .05
98_TANPF  = -0.20306
24__IX16  _______QPU        .3                                      .1        .4
11__IX17  _______QPU                                                .4      1.E3
98__QREF  =__IX16+__IX17
99___QPF  =_PELEC * _TANPF * _PFFLG
 0_QCTRL          +___QPF         +__QEXT             1.   -.7    .7
 1__QREG          +_QCTRL         -____QG             1.            _VQMIN_VQMAX
        .1        .1
                  1.
98____ND  = _QCTRL / _VFILT
 1_NDFLT  +____ND                                     1.
        1.
        1.      .015
 1_IQRAW          +_VFGIN         -_VFILT             1.            _IQMIN_IQMAX
        1.        5.
                  1.
98_IQFRZ  =      0.0
 0_IQCMD  +_NDFLG +_IQINJ                 +_IQFLG     1.            _IQMIN_IQMAX
98__IMAX  =      1.2
98_PQFLG  =      0.0
98_IQLIM  =SQRT(__IMAX*__IMAX - _PQFLG*_IPCMD*_IPCMD)
98_IPLIM  =SQRT(__IMAX*__IMAX - (1-_PQFLG)*_IQCMD*_IQCMD)
98_IQMAX63        +__VDL1         +_IQLIM                  -1.
98_IPMAX63        +__VDL2         +_IPLIM                  -1.
98_IQMIN  = - _IQMAX
98_IQINJ  = _IQVRF * __VDIP
98_VREF1  =      0.0
98_QFLAG  =       1.
24__IX18  _______PPU        .3                                      .1        .4
11__IX19  _______PPU                                                .4      1.E3
98__PREF  =__IX18+__IX19
99_PREFW  =__PREF * (NOT(_RFLAG) + _RFLAG*____WE)
98_RFLAG  =      0.0
 1__PORD  +_PREFW                                     1.            __PMIN__PMAX
        1.
        1.       .03
98__PMIN  =      0.0
98__PMAX  =       1.
98_IPRAW  = __PORD / _VFILT
 0_IPCMD                  +_IPRAW                     1.            __PMIN_IPMAX
98_VQMAX  =     1.07
98_VQMIN  =      0.9
99___IGR  =SQRT(___IGD*___IGD+___IGQ*___IGQ)
98____KC  =      0.0
98____RC  =    0.001
98____XC  =     0.01
99__VLDC  =SQRT(_VFILT*_VFILT-(___ZC2*___IGR*___IGR))
98___ZC2  =  1.01E-4
99_VCTRL  =(____KC*____QG+__VGPU)*(1-_LDCFG) + _LDCFG*__VLDC
98_LDCFG  =      0.0
98_REFFG  =       1.
 1_VCLAG  +_VCTRL                                     1.
        1.
        1.       .02
 1_QGLAG  +____QG                                     1.
        1.
        1.       .02
99__QEX1  =(__QREF-_QGLAG)*(1-_REFFG) + _REFFG*(_VREF0-_VCLAG)
98__QEX256                +__QEX1                     1.
           -2000            -999
            -999            -999
             999             999
            2000             999
           9999.
 1__QEX3                  +__QEX2                    .25   -.7    .7
        5.       10.
                  1.
 1__QEX4  +__QEX3                                     1.
        1.
        1.       .08
 1_PGLAG  +____PG                                     1.
        1.
        1.       .03
99___DWP  =(____WC - ____WE) / ____WC
98__DWDB56                +___DWP                    20.
           -9999              -1
           -0.06              -1
           -0.01               0
            1000               0
           9999.
99__PEX1  =(__PREF - _PGLAG + __DWDB) * _FRQFG
98_FRQFG  =       1.
 1__PEX2                  +__PEX1                     1.          1.
       .05        .1
                  1.
 1__PEX3  +__PEX2                                     1.
        1.
        1.       .08
98_PFFLG  =      0.0
99__QEXT  =__QEX4 * (1.0 - _PFFLG)
99_NDFLG  =_NDFLT * (1.0 - _QFLAG)
99_IQFLG  =_IQRAW * _QFLAG
98____IQ  =     1. * _IQREF
98_VFLAG  =       1.
99_VFGIN  =__QREG * _VFLAG + __QEXT * (1.0-_VFLAG) * (1.0-_PFFLG)
98__OUTF  =____WE
98__OUTP  =__PDQ0
98__OUTQ  =__QDQ0
77__VGPU  ____VREFPU
77_VFILT  ____VREFPU
77_VCLAG  ____VREFPU
77__QEX3  ____VREFPU
77__QEX4  ____VREFPU
77__OUTF    376.9911
77__OUTP          0.
77__OUTQ          0.
/BRANCH
  ____IA___IGA             0.001
  ____IB___IGB             0.001
  ____IC___IGC             0.001
  ___IGA                    1.E3        .001                                   0
  ___IGB                    1.E3        .001                                   0
  ___IGC                    1.E3        .001                                   0
/SWITCH
  ___IGA__PCCA                                        MEASURING                0
  ___IGB__PCCB                                        MEASURING                0
  ___IGC__PCCC                                        MEASURING                0
/SOURCE
60____IA-1                                                         -1.      1.E3
60____IB-1                                                         -1.      1.E3
60____IC-1                                                         -1.      1.E3
$EOF   User-supplied header cards follow.         12-Jul-24  16:24:35
ARG __PCC, __OUT
ARG __VOLTBASE, _POWERBASE, __CURRBASE, _______PPU, _______QPU, ____VREFPU
NUM __VOLTBASE, _POWERBASE, __CURRBASE, _______PPU, _______QPU, ____VREFPU
DUM _COSTH, _SINTH, _THETA, _ALPHA, __BETA, ___VGD, ___VGQ, ___IGD, ___IGQ
DUM __PDQ0, __QDQ0, ___VGR, _IQRMX, _IQRMN, _IALPH, _IBETA, _IPREF, _IPCMD
DUM _IQREF, _IQCMD, ____ID, _LVACM, __VGPU, ____PG, ____QG, ____DW, ____WE
DUM ____WC, _POWER, _VLVPL, __LVPL, _LVPRR, _LVPSW, _IOLIM, ___KCV, _VSWEL
DUM __VSAG, _VFILT, _VREF0, __VDIP, _IQVRF, __VDL1, __VDL2, _PELEC, _TANPF
DUM __QREF, ___QPF, _QCTRL, __QREG, ____ND, _NDFLT, _IQRAW, _IQFRZ, _IQCMD
DUM __IMAX, _PQFLG, _IQLIM, _IPLIM, _IQMAX, _IPMAX, _IQMIN, _IQINJ, _VREF1
DUM _QFLAG, _PREFW, _RFLAG, __PORD, __PMIN, __PMAX, _IPRAW, _IPCMD, _VQMAX
DUM _VQMIN, ___IGR, ____KC, ____RC, ____XC, __VLDC, ___ZC2, _VCTRL, _LDCFG
DUM _REFFG, _VCLAG, _QGLAG, __QEX1, __QEX2, __QEX3, __QEX4, _PGLAG, ___DWP
DUM __DWDB, __PEX1, _FRQFG, __PEX2, __PEX3, _PFFLG, __QEXT, _NDFLG, _IQFLG
DUM ____IQ, _VFLAG, _VFGIN, ____IA, ____IB, ____IC, ___IGA, ___IGB, ___IGC
DUM __IX16, __IX17, __IX18, __IX19, _VALPH, _VBETA, __PREF
